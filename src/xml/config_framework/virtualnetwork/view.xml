<!--
 Copyright (c) 2013 Juniper Networks, Inc. All rights reserved.
-->
<?xml version="1.0" encoding="UTF-8"?>
<page>
    <urls>
        <url>/api/tenants/config/domains</url>
        <url>/api/tenants/config/projects</url>        
    </urls>
    <tab title="Networks" rows="2">
        <table id="virtualnetworks" row="1" title="" get-url="/api/tenants/config/virtual-network/{{vnuuid}}"
               datasource-url="/api/tenants/config/virtual-networks?tenant_id=default-domain:{{getSelectedProjectName()}}">
            <server-paging>false</server-paging>
            <filterable at="client" />
            <sortable at="client" />
            <selectable multiple="false" />
            <target>
                <table>ipblock</table>
                <table>fips</table>
                <table>networkpolicies</table>
                <table>routinginstances</table>
            </target>
            <paging>false</paging>
            <columns>
                <column width="25%" title="Network" path="$.virtual-networks[*].fq_name[2]" field="network" />
                <column width="75%" title="Description" field="networkdescription" />
                <column path="$.virtual-networks[*].uuid" field="vnuuid" visible="false" />
            </columns>
            <actions>
                <action type="add" title="Create Network" submit-url="/api/tenants/config/virtual-networks">
                    <template>
                        {
                            "virtual-network": {
                                "parent_type": "project",
                                "fq_name": [
                                    "{{$.projects[0].fq_name[0]}}",
                                    "{{$.project.fq_name[1]}}",
                                    "{{network}}"
                                ],
                                "route_target_list": {
                                    "route_target": [
                                        "getRTString({{route_target}})"
                                    ]
                                },
                                "network_ipam_refs": [
                                    {
                                        "attr": {
                                            "ipam_subnets": [
                                                {
                                                    "subnet": {
                                                        "ip_prefix": "getIPPrefix({{ipblock}})",
                                                        "ip_prefix_len": "getIPPrefixLen({{ipblock}})"
                                                    }
                                                }
                                            ]
                                        },
                                        "to": [
                                            "{{$.projects[0].fq_name[0]}}",
                                            "{{$.project.fq_name[1]}}",
                                            "{{ipoptions}}"
                                        ]
                                    }
                                ],
                                "network_policy_refs": [
                                    {
                                        "attr" : {},
                                        "to": [
                                            "{{$.projects[0].fq_name[0]}}",
                                            "{{$.project.fq_name[1]}}",
                                            "{{policy}}"
                                        ]
                                    }
                                ]
                            }
                        }
                    </template>
                    <forms>
                        <form title="Network">
                            <elements>
                                <row>
                                    <col>
                                        <element width="240" labelwidth="90" mandatory="true" label="Network" type="textbox" path="$.virtual-networks[*].fq_name[2]" field="network" />
                                    </col>
                                    <col>
                                        <element width="240" labelwidth="90" label="Policy" type="multicombo" helptext="" setpath="$.virtual-network.network_policy_refs[*].to[2]/$.virtual-network.network_policy_refs[*]/to.2/virtual-network.network_policy_refs" path="$.network-policys[*].fq_name[2]" field="policy" />
                                    </col>
                                </row>
                                <row>
                                    <col>
                                        <element width="240" labelwidth="90" label="IP Block" helptext="Optional" type="textbox" path="{{$.virtual-network.subnets[*].ipam_subnet.subnet.ip_prefix}}/{{$.virtual-network.subnets[*].ipam_subnet.subnet.ip_prefix_len}}" field="ipblock" />
                                    </col>
                                    <col>
                                        <element width="240" labelwidth="90" label="IP Options" mandatory="true" type="combobox" setpath="$.virtual-network.network_ipam_refs.to" path="$.network-ipams[*].fq_name[2]" field="ipoptions" />
                                    </col>
                                </row>
                            </elements>
                        </form>
                        <form title="Route Target">
                            <elements>
                                <row>
                                    <col>
                                        <element width="180" changeAction="populateASN" label="Route Target" labelwidth="90" helptext="ASN" type="textbox" field="route_target_asn" />
                                    </col>
                                    <col>
                                        <element width="140" changeAction="populateRT" label=":" labelwidth="20" helptext="0 - 4294967295" type="textbox" field="route_target_rt" />
                                        <element id="hiddenRT" type="hidden" value=":" field="route_target"/>
                                    </col>
                                </row>
                            </elements>
                       </form>
                    </forms>
                </action>
                <action type="delete" submit-url="/api/tenants/config/virtual-network/{{vnuuid}}"/>
            </actions>
        </table>
        <tab title="IP Blocks" row="2">
            <table id="ipblock" title="IP Blocks for {{network}}">
                <server-paging>false</server-paging>
                <filterable at="client" />
                <sortable at="client" />
                <selectable multiple="false" />
                <paging>false</paging>
                <columns>
                    <column primary="true" title="IP Block" path="{{$.virtual-network.network_ipam_refs[*].subnet.ipam_subnet}}" field="ipblock" />
                    <column title="IP Range" format="getIPRange({{$.virtual-network.network_ipam_refs[*].subnet.ipam_subnet}})" field="iprange" />
                    <column title="IP Options" path="{{$.virtual-network.network_ipam_refs[*].subnet.ipam[2]}}" field="ipoptions" />
                    <column path="$.virtual-network.network_ipam_refs[*].subnet.uuid" field="ipamuuid" visible="false" />
                </columns>
                <actions>
                    <action type="add" title="Add IP Block to Network" text="Add IP Block"  submit-url="/api/tenants/config/virtual-network/{{vnuuid}}/ipams">
                    <template>
                        {
                            "virtual-network": {
                                "fq_name": [
                                    "{{$.projects[0].fq_name[0]}}",
                                    "{{$.project.fq_name[1]}}",
                                    "{{$.virtual-network.fq_name[2]}}"
                                ],  
                                "network_ipam_refs": [
                                    {
                                        "attr": {
                                            "ipam_subnets": [
                                                {
                                                    "subnet": {
                                                        "ip_prefix": "getIPPrefix({{ipblock}})",
                                                        "ip_prefix_len": "getIPPrefixLen({{ipblock}})"
                                                    }
                                                }
                                            ]
                                        },
                                        "to": [
                                            "{{$.projects[0].fq_name[0]}}",
                                            "{{$.project.fq_name[1]}}",
                                            "{{ipoptions}}"
                                        ]
                                    }
                                ]
                            }
                        }
                    </template>
                    <forms>
                        <form title="">
                            <elements>
                                <row>
                                    <col>
                                        <element width="280" labelwidth="150" label="IP Block" type="textbox" field="ipblock" />
                                    </col>
                                </row>
                                <row>
                                    <col>
                                        <element width="280" labelwidth="150" label="IP Address Management" path="$.network-ipams[*].fq_name[2]" type="combobox" field="ipoptions" />
                                    </col>
                                </row>
                            </elements>
                        </form>
                    </forms>                    
                    </action>
                    <action type="delete" method="PUT"
                    path="$.virtual-network.network_ipam_refs" text="Release"
                    submit-url="/api/tenants/config/virtual-network/{{vnuuid}}/ipams"/>
                </actions>
            </table>
        </tab>
        <tab title="Floating IP Pools" row="2">
            <table id="fips" title="Floating IP Pools for {{network}}">
                <server-paging>false</server-paging>
                <filterable at="client" />
                <sortable at="client" />
                <selectable multiple="false" />
                <paging>false</paging>
                <columns>
                    <column width="15%" title="Pool Name" path="$.virtual-network.floating_ip_pools[*].to[3]" field="poolname" />
                    <column width="70%" title="Assigned Projects" path="getAssignedProjectsForVN({{$.virtual-network.floating_ip_pools[*]}})" field="assignedprojects" />
                    <column path="$.virtual-network.floating_ip_pools[*].uuid" field="floatingipuuid" visible="false" />
                </columns>
                <actions>
                    <action type="add" title="Create Floating IP Pool"  submit-url="/api/tenants/config/virtual-network/{{vnuuid}}/floatingip-pools">
                        <template>
                        {
                            "virtual-network": {
                                "parent_type": "virtual-network",
                                "uuid":"{{$.virtual-network.uuid}}",
                                "name":"{{$.virtual-network.fq_name[2]}}",
                                "fq_name":[
                                    "{{$.projects[0].fq_name[0]}}",
                                    "{{$.project.fq_name[1]}}",
                                    "{{$.virtual-network.fq_name[2]}}"                                    
                                ],
                                "floating_ip_pools":[
                                    {
                                        "to":[
                                            "{{$.projects[0].fq_name[0]}}",
                                            "{{$.project.fq_name[1]}}",
                                            "{{$.virtual-network.fq_name[2]}}",
                                            "{{poolname}}"
                                        ],
                                        "projects":[
                                            {
                                                "to":[
                                                    "{{$.projects[0].fq_name[0]}}",
                                                    "{{assignedprojects}}"
                                                ],
                                                "uuid" : "getProjectUUID({{assignedprojects}})"
                                            }
                                        ]
                                    }
                                ]
                            }
                        }
                        </template>
                        <forms>
                            <form title="">
                                <elements>
                                    <row>
                                        <col>
                                            <element width="300" labelwidth="175" mandatory="true" label="Pool Name" type="textbox" field="poolname" />
                                        </col>
                                    </row>
                                    <row>
                                        <col>
                                            <element width="250" labelwidth="135" changeAction="handleAllowAllProjects" label="Assign to All Projects" type="checkbox" field="allprojects" />
                                        </col>
                                        <col/>
                                    </row>
                                    <row>
                                        <col>
                                            <element datasource-url="/api/tenants/config/projects" setpath="$.virtual-network.floating_ip_pools[*].projects[*].to[1]/$.virtual-network.floating_ip_pools[*].projects[*]/to.1/virtual-network.floating_ip_pools.0.projects+$.virtual-network.floating_ip_pools[*].projects[*].uuid/$.virtual-network.floating_ip_pools[*].projects[*]/uuid/virtual-network.floating_ip_pools.0.projects" lhspath="$.projects[*].fq_name[1]" rhspath="getNameFromFQN()" lhslabel="Available Projects" rhslabel="Assigned Projects" type="multiselect" lhsfield="availableprojects" field="assignedprojects" />
                                        </col>
                                    </row>
                                </elements>
                            </form>
                        </forms>
                    </action>
                    <action type="edit" title="Edit Floating IP Pool"  submit-url="/api/tenants/config/virtual-network/{{vnuuid}}/floatingip-pool/{{floatingipuuid}}">
                        <template>
                        {
                            "virtual-network": {
                                "uuid":"{{$.virtual-network.uuid}}",
                                "floating_ip_pools":[
                                    {
                                        "to":[
                                            "{{$.projects[0].fq_name[0]}}",
                                            "{{$.project.fq_name[1]}}",
                                            "{{$.virtual-network.fq_name[2]}}",
                                            "{{poolname}}"
                                        ],
                                        "projects":[
                                            {
                                                "to":[
                                                    "{{$.projects[0].fq_name[0]}}",
                                                    "{{assignedprojects}}"
                                                ],
                                                "uuid" : "getProjectUUID({{assignedprojects}})"
                                            }
                                        ]
                                    }
                                ]
                            }
                        }
                        </template>                    
                        <forms>
                            <form title="">
                                <elements>
                                    <row>
                                        <col>
                                            <element label="Pool Name" width="300" labelwidth="175" path="" type="textbox" field="poolname" editable="false" />
                                        </col>
                                    </row>
                                    <row>
                                        <col>
                                            <element label="Allow All Projects" width="250" labelwidth="125" changeAction="handleAllowAllProjects" type="checkbox" field="allprojects"/>
                                        </col>
                                        <col/>
                                    </row>
                                    <row>
                                        <col>
                                            <element datasource-url="/api/tenants/config/projects" setpath="$.virtual-network.floating_ip_pools[*].projects[*].to[1]/$.virtual-network.floating_ip_pools[*].projects[*]/to.1/virtual-network.floating_ip_pools.0.projects+$.virtual-network.floating_ip_pools[*].projects[*].uuid/$.virtual-network.floating_ip_pools[*].projects[*]/uuid/virtual-network.floating_ip_pools.0.projects" lhspath="$.projects[*].fq_name[1]" rhspath="getSelectedProjects()" lhslabel="Available Projects" rhslabel="Assigned Projects" type="multiselect" lhsfield="availableprojects" field="assignedprojects" />
                                        </col>
                                    </row>
                                </elements>
                            </form>
                        </forms>
                    </action>
                    <action type="delete" submit-url="/api/tenants/config/virtual-network/{{vnuuid}}/floatingip-pool/{{floatingipuuid}}"/>
                </actions>
            </table>
        </tab>
        <tab title="Attached Network Policy" row="2">
            <table id="networkpolicies" title="Network Policies attached to {{network}}">
                <server-paging>false</server-paging>
                <filterable at="client" />
                <sortable at="client" />
                <selectable multiple="false" />
                <paging>false</paging>
                <columns>
                    <column title="Network Policy" path="$.virtual-network.network_policy_refs[*].to" field="attachedpolicies" />
                    <column path="$.virtual-network.network_policy_refs[*].uuid" field="policyuuid" visible="false" />
                </columns>
                <actions>
                    <action type="edit" process="table" title="Attach Network Policies to Network"  submit-url="/api/tenants/config/virtual-network/{{vnuuid}}/network-policys">
                        <template>
                            {
                                "virtual-network": {
                                    "network_policy_refs": [
                                        {
                                            "attr": {
                                                "major": 0,
                                                "minor": 0
                                            },
                                            "to": [
                                                "{{$.projects[0].fq_name[0]}}",
                                                "{{$.project.fq_name[1]}}",
                                                "{{attachedpolicies}}"
                                            ],
                                            "uuid" : "getPolicyUUID({{attachedpolicies}})"
                                        }
                                    ]
                                }
                            }
                        </template>
                        <forms>
                            <form title="">
                                <elements>
                                    <row>
                                        <col>
                                            <element datasource-url="/api/tenants/config/policys?tenant_id=default-domain:{{getSelectedProjectName()}}" lhspath="$.network-policys[*].fq_name[2]"
                                                     rhspath="getNameFromFQN()" lhslabel="Available Policies" setpath="$.virtual-network.network_policy_refs[*].to[2]/$.virtual-network.network_policy_refs[*]/to.2/virtual-network.network_policy_refs+$.virtual-network.network_policy_refs[*].uuid/$.virtual-network.network_policy_refs[*]/uuid/virtual-network.network_policy_refs" rhslabel="Attached Policies" type="multiselect" lhsfield="availablepolicies" rhsfield="attachedpolicies" field="attachedpolicies"/>
                                        </col>
                                    </row>
                                </elements>
                            </form>
                        </forms>
                    </action>
                </actions>
            </table>
        </tab>
        <tab title="Route Targets" row="2">
            <table id="routinginstances" title="Route Targets for {{network}}">
                <server-paging>false</server-paging>
                <filterable at="client" />
                <sortable at="client" />
                <selectable multiple="false" />
                <paging>false</paging>
                <columns>
                    <column primary="true" title="Route Target" format="removeRTString({{$.virtual-network.route_target_list.route_target[*]}})" field="route_target" />
                </columns>
                <actions>
                    <action type="add" method="PUT" process="table" text="Add" title="Add Route Target for Network"  submit-url="/api/tenants/config/virtual-network/{{vnuuid}}/route-targets">
                        <template>
                            {
                                "virtual-network": {
                                    "route_target_list": {
                                        "route_target": [
                                            "getRTString({{route_target}})"
                                        ]
                                    }
                                }
                            }
                        </template>
                        <forms>
                            <form title="">
                                <elements>
                                    <row>
                                        <col>
                                            <element width="180" labelwidth="90" mandatory="true" changeAction="populateASN" label="Route Target" helptext="ASN" type="textbox" field="route_target_asn" />
                                        </col>
                                        <col>
                                            <element width="140" labelwidth="20" mandatory="true" changeAction="populateRT" label=":" helptext="0 - 4294967295" type="textbox" field="route_target_rt" />
                                            <element id="hiddenRT" type="hidden" value=":" field="route_target" setpath="$.virtual-network.route_target_list.route_target[*]/$.virtual-network.route_target_list/route_target/virtual-network.route_target_list"/>
                                        </col>
                                    </row>
                                </elements>
                           </form>
                        </forms>
                    </action>
                    <action type="delete" method="PUT" path="$.virtual-network.route_target_list.route_target" submit-url="/api/tenants/config/virtual-network/{{vnuuid}}/route-targets"/>
                </actions>
            </table>
        </tab>
    </tab>
    <tab title="Network Policy" rows="2">
        <table id="vnpolicies" row="1" title="" get-url="/api/tenants/config/policy/{{networkpolicyuuid}}"
               datasource-url="/api/tenants/config/policys?tenant_id=default-domain:{{getSelectedProjectName()}}">
            <server-paging>false</server-paging>
            <filterable at="client" />
            <sortable at="client" />
            <selectable multiple="false" />
            <paging>false</paging>
            <target>
                <table>associatednetworks</table>
                <table>policyrules</table>                
            </target>
            <columns>
                <column width="25%" title="Network Policy" path="$.network-policys[*].fq_name[2]" field="networkpolicy" />
                <column width="75%" title="Description" field="policydescription" />
                <column path="$.network-policys[*].uuid" field="networkpolicyuuid" visible="false" />
            </columns>
            <actions>
                <action type="add" title="Create Network Policy"  submit-url="/api/tenants/config/policys">
                    <template>
                        {
                            "network-policy" : 
                                {
                                    "parent_type": "project",
                                    "fq_name": [
                                        "{{$.projects[0].fq_name[0]}}",
                                        "{{$.project.fq_name[1]}}",
                                        "{{networkpolicy}}"
                                    ]
                                }
                        }                    
                    </template>
                    <forms>
                        <form title="Network Policy">
                            <elements>
                                <row>
                                    <col>
                                        <element width="280" labelwidth="130" mandatory="true" label="Network Policy" type="textbox" field="networkpolicy" />
                                    </col>
                                </row>
                            </elements>
                       </form>
                    </forms>
                </action>
                <action type="delete" submit-url="/api/tenants/config/policy/{{networkpolicyuuid}}" />
            </actions>
        </table>
        <tab title="Policy Rules" row="2">
            <table id="policyrules" title="Rules for {{networkpolicy}}">
                <server-paging>false</server-paging>
                <filterable at="client" />
                <sortable at="client" />
                <selectable multiple="false" />
                <paging>false</paging>
                <columns>
                    <column width="15%" title="Sequence" path="{{$.network-policy.network_policy_entries.policy_rule[*].rule_sequence.major}}.{{$.network-policy.network_policy_entries.policy_rule[*].rule_sequence.minor}}" field="sequence" />
                    <column width="85%" title="Rule Details" format="formatPolicyRule({{$.network-policy.network_policy_entries.policy_rule[*]}})" field="ruledetails" />
                    <column path="$.network-policy.network_policy_entries.policy_rule[*].uuid" field="policyuuid" visible="false" />
                    <column primary="true" path="$.network-policy.network_policy_entries.policy_rule[*].rule_sequence.major" field="major" visible="false" />
                    <column primary="true" path="$.network-policy.network_policy_entries.policy_rule[*].rule_sequence.minor" field="minor" visible="false" />
                </columns>
                <actions>
                    <action type="add" text="Add Rule" title="Add Rule"  submit-url="/api/tenants/config/policy/{{networkpolicyuuid}}/network-policy-entries" validate="policyValidator">
                        <template>
                            {
                                "network-policy": {
                                    "network_policy_entries": {
                                        "policy_rule": [
                                            {
                                                "ui_rule_id" : "getRuleDict({{ruleseq}})",
                                                "action_list": {
                                                    "service_chain_type": "getServiceChainType({{apply_service}})",
                                                    "simple_action": "getAction({{simple_action}})",
                                                    "gateway_name" : null, 
                                                    "apply_service" : "getApplyServices({{apply_service}})",
                                                    "mirror_to" : "getMirrorServices({{mirror_to}})"
                                                },
                                                "application": [
                                                ],
                                                "direction": "getDirection({{direction}})",
                                                "dst_addresses": [
                                                    {
                                                        "security_group": null,
                                                        "subnet": {
                                                            "ip_prefix" : "",
                                                            "ip_prefix_len" : ""
                                                        },    
                                                        "virtual_network": "checkValidDestinationNetwork({{destnetwork}})"
                                                    }
                                                ],
                                                "dst_ports": [
                                                    {
                                                        "end_port": "getEndPort({{destport}})",
                                                        "start_port": "getStartPort({{destport}})"
                                                    }
                                                ],
                                                "protocol": "getProtocol({{protocol}})",
                                                "rule_sequence": {
                                                    "major": -1,
                                                    "minor": -1
                                                },
                                                "src_addresses": [
                                                    {
                                                        "security_group": null,
                                                        "subnet": {
                                                            "ip_prefix" : "",
                                                            "ip_prefix_len" : ""
                                                        },
                                                        "virtual_network": "checkValidSourceNetwork({{srcnetwork}})"
                                                    }
                                                ],
                                                "src_ports": [
                                                    {
                                                        "end_port": "getEndPort({{srcport}})",
                                                        "start_port": "getStartPort({{srcport}})"
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            }
                        </template>
                        <forms>
                            <form title="Policy Rule">
                                <elements>
                                    <row>
                                        <col>
                                            <element width="120" highlightfirst="false" changeAction="handleSequence" helptext="Rule ID (Last)" type="combobox" field="ruleid">
                                                <values>
                                                    <value>Last</value>
                                                    <value>First</value>
                                                    <value>After</value>
                                                </values>
                                            </element>
                                            <element id="hiddenruleseq" type="hidden" value="last:null" field="ruleseq"/>
                                        </col>
                                        <col>
                                            <element width="135" changeAction="populateSeq" visible="false" path="{{$.network-policy.network_policy_entries.policy_rule[*].rule_sequence.major}}.{{$.network-policy.network_policy_entries.policy_rule[*].rule_sequence.minor}}" helptext="Sequence" type="dropdown" field="sequence" />
                                        </col>
                                    </row>
                                    <row>
                                        <col>
                                            <element id="simpleaction" width="120" highlightfirst="false" helptext="Action (Pass)" type="combobox" field="simple_action">
                                                <values>
                                                    <value>Pass</value>
                                                    <value>Deny</value>
                                                </values>
                                            </element>
                                        </col>
                                        <col>
                                            <element width="135" highlightfirst="false" helptext="IP Protocol (any)" type="combobox" field="protocol">
                                                <values>
                                                    <value>ANY</value>
                                                    <value>TCP</value>
                                                    <value>UDP</value>
                                                    <value>ICMP</value>
                                                </values>
                                            </element>                                            
                                        </col>
                                        <col>
                                            <element width="165" highlightfirst="false" path="getFQNofVN($.virtual-networks[*].fq_name[2])" helptext="Source Network (any)" type="combobox" field="srcnetwork">
                                                <values>
                                                    <value>any</value>
                                                    <value>local</value>
                                                </values>
                                            </element>
                                        </col>
                                        <col>
                                            <element width="125" setpath="$.network-policy.network_policy_entries.policy_rule[*].src_ports[*].start_port/$.network-policy.network_policy_entries.policy_rule[*].src_ports[*]/start_port/network-policy.network_policy_entries.policy_rule[0].src_ports+$.network-policy.network_policy_entries.policy_rule[*].src_ports[*].end_port/$.network-policy.network_policy_entries.policy_rule[*].src_ports[*]/end_port/network-policy.network_policy_entries.policy_rule[0].src_ports" helptext="Source Ports (any)" type="textbox" value="" field="srcport"/>
                                        </col>
                                        <col>
                                            <element width="180" highlightfirst="false" helptext="Direction (Bidirectional)" type="combobox" field="direction">
                                                <values>
                                                    <value>Bidirectional</value>
                                                    <value>Unidirectional</value>
                                                </values>
                                            </element>
                                        </col>
                                        <col>
                                            <element width="190" highlightfirst="false" path="getFQNofVN($.virtual-networks[*].fq_name[2])" helptext="Destination Network (any)" type="combobox" field="destnetwork">
                                                <values>
                                                    <value>any</value>                                                
                                                    <value>local</value>
                                                </values>
                                            </element>
                                        </col>
                                        <col>
                                            <element width="155" setpath="$.network-policy.network_policy_entries.policy_rule[*].dst_ports[*].start_port/$.network-policy.network_policy_entries.policy_rule[*].dst_ports[*]/start_port/network-policy.network_policy_entries.policy_rule[0].dst_ports+$.network-policy.network_policy_entries.policy_rule[*].dst_ports[*].end_port/$.network-policy.network_policy_entries.policy_rule[*].dst_ports[*]/end_port/network-policy.network_policy_entries.policy_rule[0].dst_ports" helptext="Destination Ports (any)" type="textbox" value="" field="destport" />
                                        </col>
                                    </row>
                                </elements>        
                            </form>
                            <form title="Apply Service">
                                <elements>
                                    <row>
                                        <col>
                                            <element width="260" labelwidth="140" label="Apply Service" type="dropdown" id="apply_service_mode" field="apply_service_mode" >
                                                <values>
                                                    <value>Transparent</value>
                                                    <value>In-Network</value>
                                                </values>
                                            </element>
                                        </col>
                                        <col>
                                            <element width="140" type="multicombo" id="apply_service" field="apply_service" datasource-url-cb="populateApplyServices" datasource-url="/api/tenants/config/service-instance-templates/{{getSelectedDomainUUID()}}" />
                                        </col>
                                    </row>
                                    <row>
                                        <col>
                                            <element width="260" labelwidth="140" label="Mirror To" type="dropdown" id="mirror_service" field="mirror_to" highlightfirst="false" datasource-url-cb="populateMirrorServices" datasource-url="/api/tenants/config/service-instance-templates/{{getSelectedDomainUUID()}}" path="{{$.service_templates[*].service-template.service_instance_back_refs[*].to[2]}}" />
                                        </col>
                                    </row>
                                </elements>
                            </form>
                        </forms>                    
                    </action>
                    <action type="delete" submit-url="/api/tenants/config/policy/{{networkpolicyuuid}}/network-policy-entries/{{sequence}}" />
                </actions>
            </table>
        </tab>
        <tab title="Associated Networks" row="2">
            <table id="associatednetworks" title="Networks Associated with {{networkpolicy}}">
                <server-paging>false</server-paging>
                <filterable at="client" />
                <sortable at="client" />
                <selectable multiple="false" />
                <paging>false</paging>
                <columns>
                    <column title="Associated Networks" path="$.network-policy.virtual_network_back_refs[*].to" field="associatednetworks" />
                    <column path="$.network-policy.virtual_network_back_refs[*].uuid" field="associatednetworkuuid" visible="false" />
                    <column path="$.network-policy.virtual_network_back_refs[*].attr.sequence.major" field="associatednetworkmajor" visible="false" />
                    <column path="$.network-policy.virtual_network_back_refs[*].attr.sequence.minor" field="associatednetworkminor" visible="false" />
                </columns>
                <actions>
                    <action type="edit" process="table" title="Networks Associated with Network Policy"  submit-url="/api/tenants/config/policy/{{networkpolicyuuid}}/associated-networks">
                        <template>
                            {
                                "network-policy": {
                                    "virtual_network_back_refs": [
                                        {
                                            "attr": {
                                                "timer": null,
                                                "sequence": null
                                            },
                                            "uuid": "getNetworkUUID({{associatednetworks}})",
                                            "to": [
                                                "{{$.projects[0].fq_name[0]}}",
                                                "{{$.project.fq_name[1]}}",
                                                "{{associatednetworks}}"
                                            ]
                                        }
                                    ]
                                }
                            }
                        </template>
                        <forms>
                            <form title="">
                                <elements>
                                    <row>
                                        <col>
                                            <element rhspath="getNameFromFQN()"
                                                     setpath="$.network-policy.virtual_network_back_refs[*].to[2]/$.network-policy.virtual_network_back_refs[*]/to.2/network-policy.virtual_network_back_refs+$.network-policy.virtual_network_back_refs[*].uuid/$.network-policy.virtual_network_back_refs[*]/uuid/network-policy.virtual_network_back_refs" datasource-url="/api/tenants/config/virtual-networks?tenant_id=default-domain:{{getSelectedProjectName()}}" lhspath="$.virtual-networks[*].fq_name[2]" lhslabel="Available Networks" rhslabel="Associated Networks" type="multiselect" lhsfield="availablenetworks" rhsfield="associatednetworks" field="associatednetworks"/>
                                        </col>
                                    </row>
                                </elements>
                            </form>
                        </forms>
                    </action>
                </actions>
            </table>
        </tab>
    </tab> 
    <tab title="IP Address Management" rows="2">
        <table id="networkipoptions" row="1" title="" get-url="/api/tenants/config/ipam/{{ipamuuid}}" datasource-url="/api/tenants/config/ipams?tenant_id=default-domain:{{getSelectedProjectName()}}">
            <server-paging>false</server-paging>
            <filterable at="client" />
            <sortable at="client" />
            <selectable multiple="false" />
            <paging>false</paging>
            <target>
                <table>networkipoptiondetails</table>
                <table>networkdnsdetails</table>
            </target>
            <columns>
                <column width="25%" title="IPAM Option" path="$.network-ipams[*].fq_name[2]" field="ipamname" />
                <column width="75%" title="Description" field="ipamdescription" />
                <column path="$.network-ipams[*].uuid" field="ipamuuid" visible="false" />
            </columns>
                <actions>
                    <action type="add" title="Add IP Address Management"  submit-url="/api/tenants/config/ipams">
                        <template>
                            {
                                "network-ipam": {
                                    "parent_type": "project",
                                    "fq_name": [
                                        "{{$.projects[0].fq_name[0]}}",
                                        "{{$.project.fq_name[1]}}",
                                        "{{ipamname}}"
                                    ],
                                    "network_ipam_mgmt": {
                                        "dhcp_option_list": {
                                            "dhcp_option": [
                                                {
                                                    "dhcp_option_name": "getDHCPKey({{dhcpoptions}})",
                                                    "dhcp_option_value": "{{dhcpoptionvalue}}"
                                                }
                                            ]
                                        },
                                        "ipam_method": null
                                    }
                                }
                            }
                        </template>
                        <forms>
                            <form title="">
                                <elements>
                                    <row>
                                        <col>
                                            <element width="250" labelwidth="140" mandatory="true" label="Name" helptext="IPAM Name" type="textbox" field="ipamname" />
                                        </col>
                                    </row>
                                    <row>
                                        <col>
                                            <element width="110" highlightfirst="false" label="" helptext="DHCP Option" type="combobox" field="dhcpoptions">
                                                <values>
                                                    <value>DNS Server</value>
                                                    <value>NTP Server</value>
                                                    <value>Domain Name</value>
                                                </values>
                                            </element>
                                        </col>
                                        <col>
                                            <element width="110" label="" type="textbox" field="dhcpoptionvalue" />
                                        </col>
                                    </row>
                                </elements>
                            </form>
                        </forms>
                    </action>
                    <action type="delete" submit-url="/api/tenants/config/ipam/{{ipamuuid}}"/>
                </actions>
        </table>
        <tab title="DHCP Options" row="2">
            <table id="networkipoptiondetails" type="detail" title="DHCP Options for {{ipamname}}">
                <server-paging>false</server-paging>
                <filterable at="client" />
                <sortable at="client" />
                <selectable multiple="false" />
                <paging>false</paging>
                <columns>
                    <column title="Option" format="getDHCPValue({{$.network-ipam.network_ipam_mgmt.dhcp_option_list.dhcp_option[*].dhcp_option_name}})" field="name" setpath="$.network-ipam.network_ipam_mgmt.dhcp_option_list.dhcp_option[*]">
                        <rowfield>$.network-ipam.network_ipam_mgmt.dhcp_option_list.dhcp_option[*].dhcp_option_name</rowfield>
                    </column>
                    <column primary="true" title="Value" field="value">
                        <rowfield>$.network-ipam.network_ipam_mgmt.dhcp_option_list.dhcp_option[*].dhcp_option_value</rowfield>
                    </column>
                </columns>
                <actions>
                    <action process="table" type="add" method="PUT" width="110px" text="Add DHCP Option" title="DHCP Option"  submit-url="/api/tenants/config/ipam/{{ipamuuid}}">
                        <template>
                            {
                                "network-ipam": {
                                    "network_ipam_mgmt": {
                                        "ipam_method": null,
                                        "cidr_block": null,
                                        "ipam_dns_method": "getIpamDnsMode({{dhcpoptions}})",
                                        "ipam_dns_server": "getIpamDnsServer({{dhcpoptions}})",
                                        "dhcp_option_list": {
                                            "dhcp_option": [
                                                {
                                                    "dhcp_option_name": "getDHCPKey({{dhcpoptions}})",
                                                    "dhcp_option_value": "{{dhcpoptionvalue}}"
                                                }
                                            ]
                                        },
                                        "ipam_method": null
                                    }
                                }
                            }
                        </template>
                        <forms>
                            <form title="">
                                <elements>
                                    <row>
                                        <col>
                                            <element width="110" label="" highlightfirst="false" helptext="DHCP Option" type="combobox" field="dhcpoptions">
                                                <values>
                                                    <value>DNS Server</value>
                                                    <value>NTP Server</value>
                                                    <value>Domain Name</value>
                                                </values>
                                            </element>
                                        </col>
                                        <col>
                                            <element width="110" mandatory="true" label="" helptext="DHCP Value" type="textbox" field="dhcpoptionvalue" />
                                        </col>
                                    </row>
                                </elements>
                            </form>
                        </forms>
                    </action>
                    <action type="delete" method="PUT" path="$.network-ipam.network_ipam_mgmt.dhcp_option_list.dhcp_option" submit-url="/api/tenants/config/ipam/{{ipamuuid}}"/>
                </actions>                
            </table>
        </tab>
        <tab title="DNS Servers" row="2">
            <table id="networkdnsdetails" title="DNS Servers of {{ipamname}}">
                <server-paging>false</server-paging>
                <filterable at="client" />
                <sortable at="client" />
                <selectable multiple="false" />
                <paging>false</paging>
                <columns>
                    <column width="50%" title="DNS Method" field="dnsmethod" path="getDNSMethod({{$.network-ipam.network_ipam_mgmt.ipam_dns_method}})"/>
                    <column width="50%" title="DNS Servers" field="dnsservers" format="getDNSServer({{$.network-ipam.network_ipam_mgmt.ipam_dns_server}})"/>
                </columns>
                <actions>
                    <action process="table" type="add" method="PUT" width="110px" text="Associate DNS" title="DNS Server"  submit-url="/api/tenants/config/ipam/{{ipamuuid}}" validate="dnsServerValidator">
                        <template>
                            {
                                "network-ipam": {                                
                                    "network_ipam_mgmt": {
                                        "ipam_method": null,
                                        "cidr_block": null,
                                        "ipam_dns_method": "getIpamDnsMode({{ipamdnsmode}})",
                                        "ipam_dns_server": "getIpamDnsServer({{ipamdnsmodevalue}})",
                                        "dhcp_option_list": "getDHCPOptionList({{ipamdnsmode}})"
                                    }
                                }
                            }
                        </template>
                        <forms>
                            <form title="">
                                <elements>
                                    <row>
                                        <col>
                                            <element id="ipamdnsmode" width="210" labelwidth="110" value="Default DNS" label="DNS Method" changeAction="handleDNSMode" highlightfirst="true" helptext="" type="dropdown" field="ipamdnsmode">
                                                <values>
                                                    <value>None</value>
                                                    <value>Default DNS</value>
                                                    <value>Tenant DNS</value>
                                                    <value>Virtual DNS</value>
                                                </values>
                                            </element>
                                        </col>
                                        <col>
                                            <element id="ipamdnsmodevalue" width="110" label="" helptext="DNS Servers" type="combobox" highlightfirst="false" field="ipamdnsmodevalue" datasource-url="/api/tenants/config/virtual-DNSs/{{getSelectedDomainUUID()}}" path="{{$.virtual_DNSs[*].virtual-DNS.fq_name[0]}}:{{$.virtual_DNSs[*].virtual-DNS.fq_name[1]}}" />
                                        </col>
                                    </row>
                                </elements>
                            </form>
                        </forms>
                    </action>
                    <action type="delete" method="PUT" text="Disassociate" path="$.network-ipam.network_ipam_mgmt" submit-url="/api/tenants/config/ipam/{{ipamuuid}}/option"/>
                </actions>                
            </table>
        </tab>        
    </tab>
    <tab title="Allocated Floating IPs">
        <table id="allocatedfloatingips" title="" get-url="{{fipuuid}}" datasource-url="/api/tenants/config/floating-ips/{{getSelectedProjectUUID()}}">
            <server-paging>false</server-paging>
            <filterable at="client" />
            <sortable at="client" />
            <selectable multiple="false" />
            <paging>false</paging>
            <columns>
                <column width="10%" title="IP Address" path="$.floating_ip_back_refs[*].floating-ip.floating_ip_address" field="floatingipaddress" />
                <column width="22%" title="Instance" path="getInstancesOfFIP({{$.floating_ip_back_refs[*].floating-ip}})" field="instance" />
                <column width="25%" title="Floating IP Network and Pool" path="{{$.floating_ip_back_refs[*].floating-ip.fq_name[2]}}:{{$.floating_ip_back_refs[*].floating-ip.fq_name[3]}}" field="fipool" />
                <column width="22%" title="UUID" path="$.floating_ip_back_refs[*].floating-ip.uuid" field="fipuuid" />
                <column width="21%" type="action" title="Actions">
                    <values action="handleFip">
                        <value>Actions</value>
                        <value>Associate</value>
                        <value>Disassociate</value>
                    </values>
                </column>                
            </columns>
            <actions>
                <action type="add" text="Allocate" title="Allocate Floating IP to Project"  submit-url="/api/tenants/config/floating-ips">
                    <template>
                        {
                            "floating-ip": {
                                "parent_type": "floating-ip-pool", 
                                "fq_name": [
                                    "{{$.projects[0].fq_name[0]}}", 
                                    "getProjectForVNFromFIP({{fipool}})", 
                                    "getNetworkFromFIPool({{fipool}})", 
                                    "getPoolNameFromFIPool({{fipool}})"
                                ],
                                "project_refs": [
                                    {
                                        "to": [
                                            "{{$.projects[0].fq_name[0]}}",
                                            "{{$.project.fq_name[1]}}"
                                        ]
                                    }
                                ]
                            }
                        }
                    </template>
                    <forms>
                        <form title="">
                            <elements>
                                <row>
                                    <col>
                                        <element width="240" labelwidth="100" mandatory="true" label="Floating IP Pool" datasource-url="/api/tenants/config/floating-ip-pools/{{getSelectedProjectUUID()}}" path="{{$.floating_ip_pool_refs[*].to[2]}}:{{$.floating_ip_pool_refs[*].to[3]}}" type="combobox" field="fipool" />
                                    </col>
                                </row>
                            </elements>
                        </form>
                    </forms>
                </action>
                <action type="delete" text="Release" submit-url="/api/tenants/config/floating-ip/{{fipuuid}}"/>
            </actions>            
        </table>
    </tab>
</page>
